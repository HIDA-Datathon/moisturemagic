{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Moisture Magic üí¶ üßô‚Äç‚ôÇÔ∏è\n",
    "## Preprocessing of UFZ Dataset Soil Moisture \"Hohes Holz\" üìù ‚Üí üì¶\n",
    "\n",
    "**HIDA 2020 Hackthon, 2020-11-06**\n",
    "\n",
    "Maximilian Graf (xxx), Alexander Merdian-Tarko (xxx), Julius Polz (xxx), Christian Werner [[@cwerner76]](https://twitter.com/cwerner76/)  \n",
    "Source: https://github.com/HIDA-Datathon/moisturemagic.git"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import xarray as xr"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>Time</th>\n",
       "      <th>Box</th>\n",
       "      <th>Date.Time</th>\n",
       "      <th>SM1</th>\n",
       "      <th>SM1_Flag</th>\n",
       "      <th>Temp1</th>\n",
       "      <th>Temp1_Flag</th>\n",
       "      <th>SM2</th>\n",
       "      <th>SM2_Flag</th>\n",
       "      <th>Temp2</th>\n",
       "      <th>...</th>\n",
       "      <th>SM6_Flag</th>\n",
       "      <th>Temp6</th>\n",
       "      <th>Temp6_Flag</th>\n",
       "      <th>BattV</th>\n",
       "      <th>SM1_Depth</th>\n",
       "      <th>SM2_Depth</th>\n",
       "      <th>SM3_Depth</th>\n",
       "      <th>SM4_Depth</th>\n",
       "      <th>SM5_Depth</th>\n",
       "      <th>SM6_Depth</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1.2</th>\n",
       "      <th>2012-07-19</th>\n",
       "      <td>17:45:53</td>\n",
       "      <td>1</td>\n",
       "      <td>2012-07-19 17:45:53</td>\n",
       "      <td>-2.8240</td>\n",
       "      <td>Auto:Range</td>\n",
       "      <td>18.2580</td>\n",
       "      <td>OK</td>\n",
       "      <td>-5.9817</td>\n",
       "      <td>Auto:Range</td>\n",
       "      <td>18.2232</td>\n",
       "      <td>...</td>\n",
       "      <td>Auto:Range</td>\n",
       "      <td>18.3623</td>\n",
       "      <td>OK</td>\n",
       "      <td>3599</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2.2</th>\n",
       "      <th>2010-10-03</th>\n",
       "      <td>02:07:00</td>\n",
       "      <td>2</td>\n",
       "      <td>2010-10-03 02:07:00</td>\n",
       "      <td>29.9656</td>\n",
       "      <td>OK</td>\n",
       "      <td>5.0416</td>\n",
       "      <td>OK</td>\n",
       "      <td>-4.8066</td>\n",
       "      <td>Auto:Range</td>\n",
       "      <td>-15.1656</td>\n",
       "      <td>...</td>\n",
       "      <td>OK</td>\n",
       "      <td>5.7372</td>\n",
       "      <td>OK</td>\n",
       "      <td>3138</td>\n",
       "      <td>0.10</td>\n",
       "      <td>0.20</td>\n",
       "      <td>0.30</td>\n",
       "      <td>0.40</td>\n",
       "      <td>0.50</td>\n",
       "      <td>0.60</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2 rows √ó 34 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                    Time  Box           Date.Time      SM1    SM1_Flag  \\\n",
       "1.2 2012-07-19  17:45:53    1 2012-07-19 17:45:53  -2.8240  Auto:Range   \n",
       "2.2 2010-10-03  02:07:00    2 2010-10-03 02:07:00  29.9656          OK   \n",
       "\n",
       "                  Temp1 Temp1_Flag     SM2    SM2_Flag    Temp2  ...  \\\n",
       "1.2 2012-07-19  18.2580         OK -5.9817  Auto:Range  18.2232  ...   \n",
       "2.2 2010-10-03   5.0416         OK -4.8066  Auto:Range -15.1656  ...   \n",
       "\n",
       "                  SM6_Flag    Temp6 Temp6_Flag  BattV SM1_Depth  SM2_Depth  \\\n",
       "1.2 2012-07-19  Auto:Range  18.3623         OK   3599      0.05       0.05   \n",
       "2.2 2010-10-03          OK   5.7372         OK   3138      0.10       0.20   \n",
       "\n",
       "               SM3_Depth  SM4_Depth SM5_Depth  SM6_Depth  \n",
       "1.2 2012-07-19      0.05       0.05      0.05       0.05  \n",
       "2.2 2010-10-03      0.30       0.40      0.50       0.60  \n",
       "\n",
       "[2 rows x 34 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# read raw data and convert datetime\n",
    "df = pd.read_csv(\"/glacier2/dldatasets/hida2020-ufz-data/00_data.csv\", delim_whitespace=True)\n",
    "df['Date.Time'] = pd.to_datetime(df['Date.Time'])\n",
    "df.head(2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 1. Initial cleanup\n",
    "\n",
    "Steps:  \n",
    "* drop columns not needed for analysis\n",
    "* eliminate Box1 (located in first row) since it only has one measly measurement...\n",
    "* rename some columns\n",
    "* make time the index"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>box</th>\n",
       "      <th>SM1</th>\n",
       "      <th>SM1_Flag</th>\n",
       "      <th>Temp1</th>\n",
       "      <th>Temp1_Flag</th>\n",
       "      <th>SM2</th>\n",
       "      <th>SM2_Flag</th>\n",
       "      <th>Temp2</th>\n",
       "      <th>Temp2_Flag</th>\n",
       "      <th>SM3</th>\n",
       "      <th>...</th>\n",
       "      <th>SM6_Flag</th>\n",
       "      <th>Temp6</th>\n",
       "      <th>Temp6_Flag</th>\n",
       "      <th>BattV</th>\n",
       "      <th>SM1_Depth</th>\n",
       "      <th>SM2_Depth</th>\n",
       "      <th>SM3_Depth</th>\n",
       "      <th>SM4_Depth</th>\n",
       "      <th>SM5_Depth</th>\n",
       "      <th>SM6_Depth</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>time</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2010-10-03 02:07:00</th>\n",
       "      <td>2</td>\n",
       "      <td>29.9656</td>\n",
       "      <td>OK</td>\n",
       "      <td>5.0416</td>\n",
       "      <td>OK</td>\n",
       "      <td>-4.8066</td>\n",
       "      <td>Auto:Range</td>\n",
       "      <td>-15.1656</td>\n",
       "      <td>OK</td>\n",
       "      <td>-7.6653</td>\n",
       "      <td>...</td>\n",
       "      <td>OK</td>\n",
       "      <td>5.7372</td>\n",
       "      <td>OK</td>\n",
       "      <td>3138</td>\n",
       "      <td>0.1</td>\n",
       "      <td>0.2</td>\n",
       "      <td>0.3</td>\n",
       "      <td>0.4</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2010-10-03 03:07:00</th>\n",
       "      <td>2</td>\n",
       "      <td>26.1448</td>\n",
       "      <td>OK</td>\n",
       "      <td>8.4848</td>\n",
       "      <td>OK</td>\n",
       "      <td>23.7972</td>\n",
       "      <td>OK</td>\n",
       "      <td>7.7544</td>\n",
       "      <td>OK</td>\n",
       "      <td>125.1174</td>\n",
       "      <td>...</td>\n",
       "      <td>Auto:Spike</td>\n",
       "      <td>6.8154</td>\n",
       "      <td>OK</td>\n",
       "      <td>3496</td>\n",
       "      <td>0.1</td>\n",
       "      <td>0.2</td>\n",
       "      <td>0.3</td>\n",
       "      <td>0.4</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.6</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2 rows √ó 32 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     box      SM1 SM1_Flag   Temp1 Temp1_Flag      SM2  \\\n",
       "time                                                                     \n",
       "2010-10-03 02:07:00    2  29.9656       OK  5.0416         OK  -4.8066   \n",
       "2010-10-03 03:07:00    2  26.1448       OK  8.4848         OK  23.7972   \n",
       "\n",
       "                       SM2_Flag    Temp2 Temp2_Flag       SM3  ...  \\\n",
       "time                                                           ...   \n",
       "2010-10-03 02:07:00  Auto:Range -15.1656         OK   -7.6653  ...   \n",
       "2010-10-03 03:07:00          OK   7.7544         OK  125.1174  ...   \n",
       "\n",
       "                       SM6_Flag   Temp6 Temp6_Flag  BattV SM1_Depth  \\\n",
       "time                                                                  \n",
       "2010-10-03 02:07:00          OK  5.7372         OK   3138       0.1   \n",
       "2010-10-03 03:07:00  Auto:Spike  6.8154         OK   3496       0.1   \n",
       "\n",
       "                     SM2_Depth SM3_Depth  SM4_Depth SM5_Depth  SM6_Depth  \n",
       "time                                                                      \n",
       "2010-10-03 02:07:00        0.2       0.3        0.4       0.5        0.6  \n",
       "2010-10-03 03:07:00        0.2       0.3        0.4       0.5        0.6  \n",
       "\n",
       "[2 rows x 32 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = df.reset_index().drop(['level_0','level_1','Time'], axis=1).iloc[1:,:]\n",
    "df = df.rename(columns={'Box': 'box', 'Date.Time': 'time'})\n",
    "df = df.set_index('time')\n",
    "df.head(2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2. Resample to consistent 15min intervals"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "df = df.groupby('box').resample('15min').first().drop('box', axis=1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 3. Reshape dataframe (wide to short form)\n",
    "\n",
    "Steps:\n",
    "* split into variable groups\n",
    "* ignore depth (we use level for vertical stratification)\n",
    "* rename columns to level id for later melt\n",
    "* melt to narrow df form\n",
    "* convert to xarray dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>soilmoisture_flag</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>time</th>\n",
       "      <th>box</th>\n",
       "      <th>level</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2010-10-03 02:00:00</th>\n",
       "      <th>2</th>\n",
       "      <th>1</th>\n",
       "      <td>OK</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2010-10-03 02:15:00</th>\n",
       "      <th>2</th>\n",
       "      <th>1</th>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                              soilmoisture_flag\n",
       "time                box level                  \n",
       "2010-10-03 02:00:00 2   1                    OK\n",
       "2010-10-03 02:15:00 2   1                   NaN"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# split df for variable groups\n",
    "def expand_name(var, flag=False):\n",
    "    f = '_Flag' if flag else ''\n",
    "    return [f\"{var}{i}{f}\" for i in range(1,7)]\n",
    "\n",
    "df_sm = df[expand_name('SM')]\n",
    "df_temp = df[expand_name('Temp')]\n",
    "df_bat = df[['BattV']]\n",
    "\n",
    "# and quality flags\n",
    "df_sm_qa = df[expand_name('SM', flag=True)]\n",
    "df_temp_qa = df[expand_name('Temp', flag=True)]\n",
    "\n",
    "# rename columns\n",
    "for d in [df_sm, df_temp, df_sm_qa, df_temp_qa]:\n",
    "    d.columns = list(range(1,7))\n",
    "\n",
    "# melt\n",
    "df_sm = pd.melt(df_sm.reset_index(), id_vars=['box','time']).set_index(['time','box'])\n",
    "df_temp = pd.melt(df_temp.reset_index(), id_vars=['box','time']).set_index(['time','box'])\n",
    "df_sm_qa = pd.melt(df_sm_qa.reset_index(), id_vars=['box','time']).set_index(['time','box'])\n",
    "df_temp_qa = pd.melt(df_temp_qa.reset_index(), id_vars=['box','time']).set_index(['time','box'])\n",
    "\n",
    "# rename new columns\n",
    "df_sm.columns = ['level', 'soilmoisture']\n",
    "df_temp.columns = ['level', 'soiltemp']\n",
    "df_sm_qa.columns = ['level', 'soilmoisture_flag']\n",
    "df_temp_qa.columns = ['level', 'soiltemp_flag']\n",
    "\n",
    "# add level to multi-index\n",
    "df_sm = df_sm.set_index('level', append=True)\n",
    "df_temp = df_temp.set_index('level', append=True)\n",
    "df_sm_qa = df_sm_qa.set_index('level', append=True)\n",
    "df_temp_qa = df_temp_qa.set_index('level', append=True)\n",
    "\n",
    "# convert dtype of categorical columns\n",
    "df_sm_qa['soilmoisture_flag'] = df_sm_qa['soilmoisture_flag'].astype('category')\n",
    "df_temp_qa['soiltemp_flag'] = df_temp_qa['soiltemp_flag'].astype('category')\n",
    "\n",
    "df_sm_qa.head(2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Auto:BattV', 'Auto:Range', 'Auto:Spike', 'Manual', 'OK'], dtype='object')"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "array([-1,  0,  1,  2,  3,  4], dtype=int8)"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "display(df_sm_qa['soilmoisture_flag'].cat.categories)\n",
    "display(np.unique(df_sm_qa['soilmoisture_flag'].cat.codes))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 4. Convert to xarray dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n",
       "<defs>\n",
       "<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n",
       "<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "</symbol>\n",
       "<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n",
       "<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "</symbol>\n",
       "</defs>\n",
       "</svg>\n",
       "<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n",
       " *\n",
       " */\n",
       "\n",
       ":root {\n",
       "  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n",
       "  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n",
       "  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n",
       "  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n",
       "  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n",
       "  --xr-background-color: var(--jp-layout-color0, white);\n",
       "  --xr-background-color-row-even: var(--jp-layout-color1, white);\n",
       "  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n",
       "}\n",
       "\n",
       "html[theme=dark],\n",
       "body.vscode-dark {\n",
       "  --xr-font-color0: rgba(255, 255, 255, 1);\n",
       "  --xr-font-color2: rgba(255, 255, 255, 0.54);\n",
       "  --xr-font-color3: rgba(255, 255, 255, 0.38);\n",
       "  --xr-border-color: #1F1F1F;\n",
       "  --xr-disabled-color: #515151;\n",
       "  --xr-background-color: #111111;\n",
       "  --xr-background-color-row-even: #111111;\n",
       "  --xr-background-color-row-odd: #313131;\n",
       "}\n",
       "\n",
       ".xr-wrap {\n",
       "  display: block;\n",
       "  min-width: 300px;\n",
       "  max-width: 700px;\n",
       "}\n",
       "\n",
       ".xr-text-repr-fallback {\n",
       "  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-header {\n",
       "  padding-top: 6px;\n",
       "  padding-bottom: 6px;\n",
       "  margin-bottom: 4px;\n",
       "  border-bottom: solid 1px var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-header > div,\n",
       ".xr-header > ul {\n",
       "  display: inline;\n",
       "  margin-top: 0;\n",
       "  margin-bottom: 0;\n",
       "}\n",
       "\n",
       ".xr-obj-type,\n",
       ".xr-array-name {\n",
       "  margin-left: 2px;\n",
       "  margin-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-obj-type {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-sections {\n",
       "  padding-left: 0 !important;\n",
       "  display: grid;\n",
       "  grid-template-columns: 150px auto auto 1fr 20px 20px;\n",
       "}\n",
       "\n",
       ".xr-section-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-section-item input {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-section-item input + label {\n",
       "  color: var(--xr-disabled-color);\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label {\n",
       "  cursor: pointer;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label:hover {\n",
       "  color: var(--xr-font-color0);\n",
       "}\n",
       "\n",
       ".xr-section-summary {\n",
       "  grid-column: 1;\n",
       "  color: var(--xr-font-color2);\n",
       "  font-weight: 500;\n",
       "}\n",
       "\n",
       ".xr-section-summary > span {\n",
       "  display: inline-block;\n",
       "  padding-left: 0.5em;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in + label:before {\n",
       "  display: inline-block;\n",
       "  content: '‚ñ∫';\n",
       "  font-size: 11px;\n",
       "  width: 15px;\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label:before {\n",
       "  color: var(--xr-disabled-color);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label:before {\n",
       "  content: '‚ñº';\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label > span {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-section-summary,\n",
       ".xr-section-inline-details {\n",
       "  padding-top: 4px;\n",
       "  padding-bottom: 4px;\n",
       "}\n",
       "\n",
       ".xr-section-inline-details {\n",
       "  grid-column: 2 / -1;\n",
       "}\n",
       "\n",
       ".xr-section-details {\n",
       "  display: none;\n",
       "  grid-column: 1 / -1;\n",
       "  margin-bottom: 5px;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked ~ .xr-section-details {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-array-wrap {\n",
       "  grid-column: 1 / -1;\n",
       "  display: grid;\n",
       "  grid-template-columns: 20px auto;\n",
       "}\n",
       "\n",
       ".xr-array-wrap > label {\n",
       "  grid-column: 1;\n",
       "  vertical-align: top;\n",
       "}\n",
       "\n",
       ".xr-preview {\n",
       "  color: var(--xr-font-color3);\n",
       "}\n",
       "\n",
       ".xr-array-preview,\n",
       ".xr-array-data {\n",
       "  padding: 0 5px !important;\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-array-data,\n",
       ".xr-array-in:checked ~ .xr-array-preview {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-array-in:checked ~ .xr-array-data,\n",
       ".xr-array-preview {\n",
       "  display: inline-block;\n",
       "}\n",
       "\n",
       ".xr-dim-list {\n",
       "  display: inline-block !important;\n",
       "  list-style: none;\n",
       "  padding: 0 !important;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list li {\n",
       "  display: inline-block;\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list:before {\n",
       "  content: '(';\n",
       "}\n",
       "\n",
       ".xr-dim-list:after {\n",
       "  content: ')';\n",
       "}\n",
       "\n",
       ".xr-dim-list li:not(:last-child):after {\n",
       "  content: ',';\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-has-index {\n",
       "  font-weight: bold;\n",
       "}\n",
       "\n",
       ".xr-var-list,\n",
       ".xr-var-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-var-item > div,\n",
       ".xr-var-item label,\n",
       ".xr-var-item > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-even);\n",
       "  margin-bottom: 0;\n",
       "}\n",
       "\n",
       ".xr-var-item > .xr-var-name:hover span {\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-var-list > li:nth-child(odd) > div,\n",
       ".xr-var-list > li:nth-child(odd) > label,\n",
       ".xr-var-list > li:nth-child(odd) > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-odd);\n",
       "}\n",
       "\n",
       ".xr-var-name {\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-var-dims {\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-var-dtype {\n",
       "  grid-column: 3;\n",
       "  text-align: right;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-preview {\n",
       "  grid-column: 4;\n",
       "}\n",
       "\n",
       ".xr-var-name,\n",
       ".xr-var-dims,\n",
       ".xr-var-dtype,\n",
       ".xr-preview,\n",
       ".xr-attrs dt {\n",
       "  white-space: nowrap;\n",
       "  overflow: hidden;\n",
       "  text-overflow: ellipsis;\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-var-name:hover,\n",
       ".xr-var-dims:hover,\n",
       ".xr-var-dtype:hover,\n",
       ".xr-attrs dt:hover {\n",
       "  overflow: visible;\n",
       "  width: auto;\n",
       "  z-index: 1;\n",
       "}\n",
       "\n",
       ".xr-var-attrs,\n",
       ".xr-var-data {\n",
       "  display: none;\n",
       "  background-color: var(--xr-background-color) !important;\n",
       "  padding-bottom: 5px !important;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked ~ .xr-var-attrs,\n",
       ".xr-var-data-in:checked ~ .xr-var-data {\n",
       "  display: block;\n",
       "}\n",
       "\n",
       ".xr-var-data > table {\n",
       "  float: right;\n",
       "}\n",
       "\n",
       ".xr-var-name span,\n",
       ".xr-var-data,\n",
       ".xr-attrs {\n",
       "  padding-left: 25px !important;\n",
       "}\n",
       "\n",
       ".xr-attrs,\n",
       ".xr-var-attrs,\n",
       ".xr-var-data {\n",
       "  grid-column: 1 / -1;\n",
       "}\n",
       "\n",
       "dl.xr-attrs {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  display: grid;\n",
       "  grid-template-columns: 125px auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt, dd {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  float: left;\n",
       "  padding-right: 10px;\n",
       "  width: auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt {\n",
       "  font-weight: normal;\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-attrs dt:hover span {\n",
       "  display: inline-block;\n",
       "  background: var(--xr-background-color);\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-attrs dd {\n",
       "  grid-column: 2;\n",
       "  white-space: pre-wrap;\n",
       "  word-break: break-all;\n",
       "}\n",
       "\n",
       ".xr-icon-database,\n",
       ".xr-icon-file-text2 {\n",
       "  display: inline-block;\n",
       "  vertical-align: middle;\n",
       "  width: 1em;\n",
       "  height: 1.5em !important;\n",
       "  stroke-width: 0;\n",
       "  stroke: currentColor;\n",
       "  fill: currentColor;\n",
       "}\n",
       "</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;\n",
       "Dimensions:            (box: 39, level: 6, time: 302043)\n",
       "Coordinates:\n",
       "  * time               (time) datetime64[ns] 2010-09-30T02:00:00 ... 2019-05-...\n",
       "  * box                (box) int64 2 3 4 5 6 7 8 9 ... 33 34 35 36 37 38 39 40\n",
       "  * level              (level) int64 1 2 3 4 5 6\n",
       "Data variables:\n",
       "    soilmoisture       (time, box, level) float64 nan nan nan ... -13.3 45.43\n",
       "    soiltemp           (time, box, level) float64 nan nan nan ... -15.55 7.928\n",
       "    soilmoisture_flag  (time, box, level) object nan nan ... &#x27;Manual&#x27;\n",
       "    soiltemp_flag      (time, box, level) object nan nan nan ... &#x27;Manual&#x27; &#x27;OK&#x27;</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-737ccbb6-4e48-4c0f-929e-78722016d61a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-737ccbb6-4e48-4c0f-929e-78722016d61a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>box</span>: 39</li><li><span class='xr-has-index'>level</span>: 6</li><li><span class='xr-has-index'>time</span>: 302043</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-74e07151-378e-4291-901d-d8fab8bc159a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-74e07151-378e-4291-901d-d8fab8bc159a' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2010-09-30T02:00:00 ... 2019-05-...</div><input id='attrs-ada6afe8-30e9-4731-944b-b47c6259e7be' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ada6afe8-30e9-4731-944b-b47c6259e7be' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7d4e94ae-c195-4a14-aa71-9850ba62f336' class='xr-var-data-in' type='checkbox'><label for='data-7d4e94ae-c195-4a14-aa71-9850ba62f336' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2010-09-30T02:00:00.000000000&#x27;, &#x27;2010-09-30T02:15:00.000000000&#x27;,\n",
       "       &#x27;2010-09-30T02:30:00.000000000&#x27;, ..., &#x27;2019-05-12T08:00:00.000000000&#x27;,\n",
       "       &#x27;2019-05-12T08:15:00.000000000&#x27;, &#x27;2019-05-12T08:30:00.000000000&#x27;],\n",
       "      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>box</span></div><div class='xr-var-dims'>(box)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2 3 4 5 6 7 8 ... 35 36 37 38 39 40</div><input id='attrs-f05df58e-e154-4a53-afd8-1061939875c9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f05df58e-e154-4a53-afd8-1061939875c9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-95393e55-c50e-4cd8-b9f3-08545643279c' class='xr-var-data-in' type='checkbox'><label for='data-95393e55-c50e-4cd8-b9f3-08545643279c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,\n",
       "       20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37,\n",
       "       38, 39, 40])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6</div><input id='attrs-2557939f-da5a-4b22-8ce8-b4d6fc5e145d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2557939f-da5a-4b22-8ce8-b4d6fc5e145d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d599a9a8-3736-4a32-84a5-e176b5eaf010' class='xr-var-data-in' type='checkbox'><label for='data-d599a9a8-3736-4a32-84a5-e176b5eaf010' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1, 2, 3, 4, 5, 6])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a8f57896-5124-4537-8ee2-7aa9606d2986' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a8f57896-5124-4537-8ee2-7aa9606d2986' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>soilmoisture</span></div><div class='xr-var-dims'>(time, box, level)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... -14.39 -13.3 45.43</div><input id='attrs-0c883fbc-10a2-41d0-9af4-d390cdec99ae' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0c883fbc-10a2-41d0-9af4-d390cdec99ae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-87cc0cde-b4e5-4331-b46d-7cfd7ae699c8' class='xr-var-data-in' type='checkbox'><label for='data-87cc0cde-b4e5-4331-b46d-7cfd7ae699c8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>soil moisture</dd><dt><span>units :</span></dt><dd>vol percent</dd></dl></div><div class='xr-var-data'><pre>array([[[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        ...,\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan]],\n",
       "\n",
       "       [[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        ...,\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan]],\n",
       "\n",
       "       [[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        ...,\n",
       "...\n",
       "        ...,\n",
       "        [276.4272,  -9.7329,  16.6275,  10.7914, -16.2046,  17.1041],\n",
       "        [-11.99  ,  19.1701,  13.9288, -12.3166,  45.4239, -13.1884],\n",
       "        [-13.0278,      nan, -10.7404, -14.3893, -13.3332,  45.318 ]],\n",
       "\n",
       "       [[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [-14.7645,  28.6488,      nan, -14.3105,      nan,  26.5471],\n",
       "        ...,\n",
       "        [276.4272,  -9.6804,  16.6643,  10.7668, -16.2374,  17.0353],\n",
       "        [-12.0144,  19.2076,  13.2511, -12.3177,  45.4199, -13.0786],\n",
       "        [-13.0278,      nan, -10.7404, -14.3893, -13.3035,  45.4276]],\n",
       "\n",
       "       [[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [-14.7658,  28.6412,      nan, -14.2176,      nan,  26.5471],\n",
       "        ...,\n",
       "        [276.4272,  -9.6452,  16.563 ,  10.7649, -16.2046,  17.1041],\n",
       "        [-12.0367,  19.1684,  13.8002, -12.2926,  46.2452, -13.0508],\n",
       "        [-13.0278,      nan, -10.7404, -14.3893, -13.3035,  45.4276]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>soiltemp</span></div><div class='xr-var-dims'>(time, box, level)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... -17.91 -15.55 7.928</div><input id='attrs-21e5c510-5460-4914-a2d0-775a7d00bd4a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-21e5c510-5460-4914-a2d0-775a7d00bd4a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d50d1c04-0401-441a-bc6f-22d63834138d' class='xr-var-data-in' type='checkbox'><label for='data-d50d1c04-0401-441a-bc6f-22d63834138d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>soil temperature</dd><dt><span>units :</span></dt><dd>deg C</dd></dl></div><div class='xr-var-data'><pre>array([[[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        ...,\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan]],\n",
       "\n",
       "       [[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        ...,\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan]],\n",
       "\n",
       "       [[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        ...,\n",
       "...\n",
       "        ...,\n",
       "        [  8.2414, -15.2004,   7.8588,   8.0675,  61.733 ,   8.0327],\n",
       "        [-16.522 ,   9.0065,   8.6935, -16.9741,   9.0065, -17.0437],\n",
       "        [-18.3653, -18.3306, -18.4349, -17.9132, -15.5482,   7.9283]],\n",
       "\n",
       "       [[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [-15.0612,  13.4584, -13.5657, -11.3398, -15.409 ,   8.0675],\n",
       "        ...,\n",
       "        [  8.2414, -15.1308,   7.9283,   8.1718,  61.733 ,   8.0675],\n",
       "        [-16.4872,   9.0065,   8.5544, -16.9394,   8.9717, -16.9741],\n",
       "        [-18.3653, -18.3306, -18.4349, -17.9132, -15.5482,   7.9283]],\n",
       "\n",
       "       [[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [-15.0265,  13.354 , -13.4961, -11.2702, -15.3395,   8.0675],\n",
       "        ...,\n",
       "        [  8.2414, -15.096 ,   7.9283,   8.1022,  61.733 ,   8.0327],\n",
       "        [-16.522 ,   8.9717,   8.5544, -16.9394,   9.0065, -16.9741],\n",
       "        [-18.3653, -18.3306, -18.4349, -17.9132, -15.5482,   7.9283]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>soilmoisture_flag</span></div><div class='xr-var-dims'>(time, box, level)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>nan nan ... &#x27;Auto:Range&#x27; &#x27;Manual&#x27;</div><input id='attrs-c27ec9e8-b339-4851-a0c1-8c80f314d67f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c27ec9e8-b339-4851-a0c1-8c80f314d67f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-37392abf-1d58-4706-85c3-9a7b5758d48e' class='xr-var-data-in' type='checkbox'><label for='data-37392abf-1d58-4706-85c3-9a7b5758d48e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>soil moisture qa flag</dd><dt><span>units :</span></dt><dd>category</dd><dt><span>flag_values :</span></dt><dd>0,1,2,3,4</dd><dt><span>flag_meanings :</span></dt><dd>Auto:BattV Auto:Range Auto:Spike Manual OK</dd></dl></div><div class='xr-var-data'><pre>array([[[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        ...,\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan]],\n",
       "\n",
       "       [[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        ...,\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan]],\n",
       "\n",
       "       [[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        ...,\n",
       "...\n",
       "\n",
       "       [[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [&#x27;Auto:Range&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;,\n",
       "         &#x27;OK&#x27;],\n",
       "        ...,\n",
       "        [&#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;, &#x27;Manual&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;],\n",
       "        [&#x27;Auto:Range&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;],\n",
       "        [&#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;,\n",
       "         &#x27;Auto:Range&#x27;, &#x27;Manual&#x27;]],\n",
       "\n",
       "       [[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [&#x27;Auto:Range&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;,\n",
       "         &#x27;OK&#x27;],\n",
       "        ...,\n",
       "        [&#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;, &#x27;Manual&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;],\n",
       "        [&#x27;Auto:Range&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;],\n",
       "        [&#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;,\n",
       "         &#x27;Auto:Range&#x27;, &#x27;Manual&#x27;]]], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>soiltemp_flag</span></div><div class='xr-var-dims'>(time, box, level)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>nan nan nan ... &#x27;Manual&#x27; &#x27;OK&#x27;</div><input id='attrs-85b926b1-1486-4794-9ef9-949d77ace31a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-85b926b1-1486-4794-9ef9-949d77ace31a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0946b63d-abb1-4894-b006-427e5b1fcbac' class='xr-var-data-in' type='checkbox'><label for='data-0946b63d-abb1-4894-b006-427e5b1fcbac' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>soil temperature qa flag</dd><dt><span>units :</span></dt><dd>category</dd><dt><span>flag_values :</span></dt><dd>0,1,2,3,4</dd><dt><span>flag_meanings :</span></dt><dd>Auto:BattV Auto:Range Auto:Spike Manual OK</dd></dl></div><div class='xr-var-data'><pre>array([[[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        ...,\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan]],\n",
       "\n",
       "       [[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        ...,\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan]],\n",
       "\n",
       "       [[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        ...,\n",
       "...\n",
       "        [&#x27;OK&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;],\n",
       "        [&#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;Manual&#x27;],\n",
       "        [&#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;]],\n",
       "\n",
       "       [[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [&#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;],\n",
       "        ...,\n",
       "        [&#x27;OK&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;],\n",
       "        [&#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;Manual&#x27;],\n",
       "        [&#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;]],\n",
       "\n",
       "       [[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [&#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;],\n",
       "        ...,\n",
       "        [&#x27;OK&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;],\n",
       "        [&#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;Manual&#x27;],\n",
       "        [&#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;]]],\n",
       "      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-38330f0d-191f-494b-a16d-eaf6efc3e0eb' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-38330f0d-191f-494b-a16d-eaf6efc3e0eb' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>"
      ],
      "text/plain": [
       "<xarray.Dataset>\n",
       "Dimensions:            (box: 39, level: 6, time: 302043)\n",
       "Coordinates:\n",
       "  * time               (time) datetime64[ns] 2010-09-30T02:00:00 ... 2019-05-...\n",
       "  * box                (box) int64 2 3 4 5 6 7 8 9 ... 33 34 35 36 37 38 39 40\n",
       "  * level              (level) int64 1 2 3 4 5 6\n",
       "Data variables:\n",
       "    soilmoisture       (time, box, level) float64 nan nan nan ... -13.3 45.43\n",
       "    soiltemp           (time, box, level) float64 nan nan nan ... -15.55 7.928\n",
       "    soilmoisture_flag  (time, box, level) object nan nan ... 'Manual'\n",
       "    soiltemp_flag      (time, box, level) object nan nan nan ... 'Manual' 'OK'"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ds = pd.concat([df_sm, df_temp, df_sm_qa, df_temp_qa], axis=1).to_xarray()\n",
    "\n",
    "ds['soiltemp'].attrs['long_name'] = \"soil temperature\"\n",
    "ds['soiltemp'].attrs['units'] = \"deg C\"\n",
    "ds['soilmoisture'].attrs['long_name'] = \"soil moisture\"\n",
    "ds['soilmoisture'].attrs['units'] = \"vol percent\"\n",
    "\n",
    "ds['soiltemp_flag'].attrs['long_name'] = \"soil temperature qa flag\"\n",
    "ds['soiltemp_flag'].attrs['units'] = \"category\"\n",
    "ds['soiltemp_flag'].attrs['flag_values'] = ','.join([str(x) for x in np.unique(df_temp_qa['soiltemp_flag'].cat.codes.values)[1:]])\n",
    "ds['soiltemp_flag'].attrs['flag_meanings'] = ' '.join(df_temp_qa['soiltemp_flag'].cat.categories.values.tolist())\n",
    "   \n",
    "ds['soilmoisture_flag'].attrs['long_name'] = \"soil moisture qa flag\"\n",
    "ds['soilmoisture_flag'].attrs['units'] = \"category\"\n",
    "ds['soilmoisture_flag'].attrs['flag_values'] = ','.join([str(x) for x in np.unique(df_sm_qa['soilmoisture_flag'].cat.codes.values)[1:]])\n",
    "ds['soilmoisture_flag'].attrs['flag_meanings'] = ' '.join(df_sm_qa['soilmoisture_flag'].cat.categories.values.tolist())\n",
    "\n",
    "ds"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n",
       "<defs>\n",
       "<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n",
       "<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "</symbol>\n",
       "<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n",
       "<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "</symbol>\n",
       "</defs>\n",
       "</svg>\n",
       "<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n",
       " *\n",
       " */\n",
       "\n",
       ":root {\n",
       "  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n",
       "  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n",
       "  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n",
       "  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n",
       "  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n",
       "  --xr-background-color: var(--jp-layout-color0, white);\n",
       "  --xr-background-color-row-even: var(--jp-layout-color1, white);\n",
       "  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n",
       "}\n",
       "\n",
       "html[theme=dark],\n",
       "body.vscode-dark {\n",
       "  --xr-font-color0: rgba(255, 255, 255, 1);\n",
       "  --xr-font-color2: rgba(255, 255, 255, 0.54);\n",
       "  --xr-font-color3: rgba(255, 255, 255, 0.38);\n",
       "  --xr-border-color: #1F1F1F;\n",
       "  --xr-disabled-color: #515151;\n",
       "  --xr-background-color: #111111;\n",
       "  --xr-background-color-row-even: #111111;\n",
       "  --xr-background-color-row-odd: #313131;\n",
       "}\n",
       "\n",
       ".xr-wrap {\n",
       "  display: block;\n",
       "  min-width: 300px;\n",
       "  max-width: 700px;\n",
       "}\n",
       "\n",
       ".xr-text-repr-fallback {\n",
       "  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-header {\n",
       "  padding-top: 6px;\n",
       "  padding-bottom: 6px;\n",
       "  margin-bottom: 4px;\n",
       "  border-bottom: solid 1px var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-header > div,\n",
       ".xr-header > ul {\n",
       "  display: inline;\n",
       "  margin-top: 0;\n",
       "  margin-bottom: 0;\n",
       "}\n",
       "\n",
       ".xr-obj-type,\n",
       ".xr-array-name {\n",
       "  margin-left: 2px;\n",
       "  margin-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-obj-type {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-sections {\n",
       "  padding-left: 0 !important;\n",
       "  display: grid;\n",
       "  grid-template-columns: 150px auto auto 1fr 20px 20px;\n",
       "}\n",
       "\n",
       ".xr-section-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-section-item input {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-section-item input + label {\n",
       "  color: var(--xr-disabled-color);\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label {\n",
       "  cursor: pointer;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label:hover {\n",
       "  color: var(--xr-font-color0);\n",
       "}\n",
       "\n",
       ".xr-section-summary {\n",
       "  grid-column: 1;\n",
       "  color: var(--xr-font-color2);\n",
       "  font-weight: 500;\n",
       "}\n",
       "\n",
       ".xr-section-summary > span {\n",
       "  display: inline-block;\n",
       "  padding-left: 0.5em;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in + label:before {\n",
       "  display: inline-block;\n",
       "  content: '‚ñ∫';\n",
       "  font-size: 11px;\n",
       "  width: 15px;\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label:before {\n",
       "  color: var(--xr-disabled-color);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label:before {\n",
       "  content: '‚ñº';\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label > span {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-section-summary,\n",
       ".xr-section-inline-details {\n",
       "  padding-top: 4px;\n",
       "  padding-bottom: 4px;\n",
       "}\n",
       "\n",
       ".xr-section-inline-details {\n",
       "  grid-column: 2 / -1;\n",
       "}\n",
       "\n",
       ".xr-section-details {\n",
       "  display: none;\n",
       "  grid-column: 1 / -1;\n",
       "  margin-bottom: 5px;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked ~ .xr-section-details {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-array-wrap {\n",
       "  grid-column: 1 / -1;\n",
       "  display: grid;\n",
       "  grid-template-columns: 20px auto;\n",
       "}\n",
       "\n",
       ".xr-array-wrap > label {\n",
       "  grid-column: 1;\n",
       "  vertical-align: top;\n",
       "}\n",
       "\n",
       ".xr-preview {\n",
       "  color: var(--xr-font-color3);\n",
       "}\n",
       "\n",
       ".xr-array-preview,\n",
       ".xr-array-data {\n",
       "  padding: 0 5px !important;\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-array-data,\n",
       ".xr-array-in:checked ~ .xr-array-preview {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-array-in:checked ~ .xr-array-data,\n",
       ".xr-array-preview {\n",
       "  display: inline-block;\n",
       "}\n",
       "\n",
       ".xr-dim-list {\n",
       "  display: inline-block !important;\n",
       "  list-style: none;\n",
       "  padding: 0 !important;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list li {\n",
       "  display: inline-block;\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list:before {\n",
       "  content: '(';\n",
       "}\n",
       "\n",
       ".xr-dim-list:after {\n",
       "  content: ')';\n",
       "}\n",
       "\n",
       ".xr-dim-list li:not(:last-child):after {\n",
       "  content: ',';\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-has-index {\n",
       "  font-weight: bold;\n",
       "}\n",
       "\n",
       ".xr-var-list,\n",
       ".xr-var-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-var-item > div,\n",
       ".xr-var-item label,\n",
       ".xr-var-item > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-even);\n",
       "  margin-bottom: 0;\n",
       "}\n",
       "\n",
       ".xr-var-item > .xr-var-name:hover span {\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-var-list > li:nth-child(odd) > div,\n",
       ".xr-var-list > li:nth-child(odd) > label,\n",
       ".xr-var-list > li:nth-child(odd) > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-odd);\n",
       "}\n",
       "\n",
       ".xr-var-name {\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-var-dims {\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-var-dtype {\n",
       "  grid-column: 3;\n",
       "  text-align: right;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-preview {\n",
       "  grid-column: 4;\n",
       "}\n",
       "\n",
       ".xr-var-name,\n",
       ".xr-var-dims,\n",
       ".xr-var-dtype,\n",
       ".xr-preview,\n",
       ".xr-attrs dt {\n",
       "  white-space: nowrap;\n",
       "  overflow: hidden;\n",
       "  text-overflow: ellipsis;\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-var-name:hover,\n",
       ".xr-var-dims:hover,\n",
       ".xr-var-dtype:hover,\n",
       ".xr-attrs dt:hover {\n",
       "  overflow: visible;\n",
       "  width: auto;\n",
       "  z-index: 1;\n",
       "}\n",
       "\n",
       ".xr-var-attrs,\n",
       ".xr-var-data {\n",
       "  display: none;\n",
       "  background-color: var(--xr-background-color) !important;\n",
       "  padding-bottom: 5px !important;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked ~ .xr-var-attrs,\n",
       ".xr-var-data-in:checked ~ .xr-var-data {\n",
       "  display: block;\n",
       "}\n",
       "\n",
       ".xr-var-data > table {\n",
       "  float: right;\n",
       "}\n",
       "\n",
       ".xr-var-name span,\n",
       ".xr-var-data,\n",
       ".xr-attrs {\n",
       "  padding-left: 25px !important;\n",
       "}\n",
       "\n",
       ".xr-attrs,\n",
       ".xr-var-attrs,\n",
       ".xr-var-data {\n",
       "  grid-column: 1 / -1;\n",
       "}\n",
       "\n",
       "dl.xr-attrs {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  display: grid;\n",
       "  grid-template-columns: 125px auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt, dd {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  float: left;\n",
       "  padding-right: 10px;\n",
       "  width: auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt {\n",
       "  font-weight: normal;\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-attrs dt:hover span {\n",
       "  display: inline-block;\n",
       "  background: var(--xr-background-color);\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-attrs dd {\n",
       "  grid-column: 2;\n",
       "  white-space: pre-wrap;\n",
       "  word-break: break-all;\n",
       "}\n",
       "\n",
       ".xr-icon-database,\n",
       ".xr-icon-file-text2 {\n",
       "  display: inline-block;\n",
       "  vertical-align: middle;\n",
       "  width: 1em;\n",
       "  height: 1.5em !important;\n",
       "  stroke-width: 0;\n",
       "  stroke: currentColor;\n",
       "  fill: currentColor;\n",
       "}\n",
       "</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;\n",
       "Dimensions:  (box: 39, time: 302043)\n",
       "Coordinates:\n",
       "  * time     (time) datetime64[ns] 2010-09-30T02:00:00 ... 2019-05-12T08:30:00\n",
       "  * box      (box) int64 2 3 4 5 6 7 8 9 10 11 ... 31 32 33 34 35 36 37 38 39 40\n",
       "Data variables:\n",
       "    battery  (time, box) float64 nan nan nan ... 3.47e+03 3.248e+03 3.392e+03\n",
       "Attributes:\n",
       "    long_name:  battery voltage\n",
       "    units:      mV</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-617594f1-8858-4ae6-b8bb-a834e8793345' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-617594f1-8858-4ae6-b8bb-a834e8793345' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>box</span>: 39</li><li><span class='xr-has-index'>time</span>: 302043</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-8430004e-edaf-44d2-9fbc-c2b11849ca07' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8430004e-edaf-44d2-9fbc-c2b11849ca07' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2010-09-30T02:00:00 ... 2019-05-...</div><input id='attrs-358d265e-678b-4062-9eeb-1b460c9ad5d5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-358d265e-678b-4062-9eeb-1b460c9ad5d5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-247c1f52-676f-4f83-ac02-49d53e3d4e77' class='xr-var-data-in' type='checkbox'><label for='data-247c1f52-676f-4f83-ac02-49d53e3d4e77' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2010-09-30T02:00:00.000000000&#x27;, &#x27;2010-09-30T02:15:00.000000000&#x27;,\n",
       "       &#x27;2010-09-30T02:30:00.000000000&#x27;, ..., &#x27;2019-05-12T08:00:00.000000000&#x27;,\n",
       "       &#x27;2019-05-12T08:15:00.000000000&#x27;, &#x27;2019-05-12T08:30:00.000000000&#x27;],\n",
       "      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>box</span></div><div class='xr-var-dims'>(box)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2 3 4 5 6 7 8 ... 35 36 37 38 39 40</div><input id='attrs-d62c7943-7b42-4cea-902d-479bd9efdab3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d62c7943-7b42-4cea-902d-479bd9efdab3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6d6267b9-4451-49ae-88c7-695b0d68b0a0' class='xr-var-data-in' type='checkbox'><label for='data-6d6267b9-4451-49ae-88c7-695b0d68b0a0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,\n",
       "       20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37,\n",
       "       38, 39, 40])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e969bc3e-f077-48cd-a811-6eab6c88d42f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e969bc3e-f077-48cd-a811-6eab6c88d42f' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>battery</span></div><div class='xr-var-dims'>(time, box)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 3.248e+03 3.392e+03</div><input id='attrs-39e0639f-22b0-48a1-aa27-f6e0d3f557df' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-39e0639f-22b0-48a1-aa27-f6e0d3f557df' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a72b86f9-927c-446a-bff0-df162f3a542c' class='xr-var-data-in' type='checkbox'><label for='data-a72b86f9-927c-446a-bff0-df162f3a542c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[  nan,   nan,   nan, ...,   nan,   nan,   nan],\n",
       "       [  nan,   nan,   nan, ...,   nan,   nan,   nan],\n",
       "       [  nan,   nan,   nan, ...,   nan,   nan,   nan],\n",
       "       ...,\n",
       "       [  nan,   nan, 3086., ..., 3464., 3235., 3387.],\n",
       "       [  nan,   nan, 3087., ..., 3467., 3246., 3389.],\n",
       "       [  nan,   nan, 3088., ..., 3470., 3248., 3392.]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-50fa2867-9804-417d-b51f-7ea110c6612a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-50fa2867-9804-417d-b51f-7ea110c6612a' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>battery voltage</dd><dt><span>units :</span></dt><dd>mV</dd></dl></div></li></ul></div></div>"
      ],
      "text/plain": [
       "<xarray.Dataset>\n",
       "Dimensions:  (box: 39, time: 302043)\n",
       "Coordinates:\n",
       "  * time     (time) datetime64[ns] 2010-09-30T02:00:00 ... 2019-05-12T08:30:00\n",
       "  * box      (box) int64 2 3 4 5 6 7 8 9 10 11 ... 31 32 33 34 35 36 37 38 39 40\n",
       "Data variables:\n",
       "    battery  (time, box) float64 nan nan nan ... 3.47e+03 3.248e+03 3.392e+03\n",
       "Attributes:\n",
       "    long_name:  battery voltage\n",
       "    units:      mV"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_bat = df[['BattV']]\n",
    "df_bat = df_bat.reset_index()\n",
    "df_bat.columns = ['box', 'time','battery']\n",
    "df_bat = df_bat.set_index(['time', 'box'])\n",
    "ds_bat = df_bat.to_xarray()\n",
    "\n",
    "ds_bat.attrs['long_name'] = \"battery voltage\"\n",
    "ds_bat.attrs['units'] = \"mV\"\n",
    "\n",
    "ds_bat"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n",
       "<defs>\n",
       "<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n",
       "<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n",
       "</symbol>\n",
       "<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n",
       "<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n",
       "<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n",
       "</symbol>\n",
       "</defs>\n",
       "</svg>\n",
       "<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n",
       " *\n",
       " */\n",
       "\n",
       ":root {\n",
       "  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n",
       "  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n",
       "  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n",
       "  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n",
       "  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n",
       "  --xr-background-color: var(--jp-layout-color0, white);\n",
       "  --xr-background-color-row-even: var(--jp-layout-color1, white);\n",
       "  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n",
       "}\n",
       "\n",
       "html[theme=dark],\n",
       "body.vscode-dark {\n",
       "  --xr-font-color0: rgba(255, 255, 255, 1);\n",
       "  --xr-font-color2: rgba(255, 255, 255, 0.54);\n",
       "  --xr-font-color3: rgba(255, 255, 255, 0.38);\n",
       "  --xr-border-color: #1F1F1F;\n",
       "  --xr-disabled-color: #515151;\n",
       "  --xr-background-color: #111111;\n",
       "  --xr-background-color-row-even: #111111;\n",
       "  --xr-background-color-row-odd: #313131;\n",
       "}\n",
       "\n",
       ".xr-wrap {\n",
       "  display: block;\n",
       "  min-width: 300px;\n",
       "  max-width: 700px;\n",
       "}\n",
       "\n",
       ".xr-text-repr-fallback {\n",
       "  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-header {\n",
       "  padding-top: 6px;\n",
       "  padding-bottom: 6px;\n",
       "  margin-bottom: 4px;\n",
       "  border-bottom: solid 1px var(--xr-border-color);\n",
       "}\n",
       "\n",
       ".xr-header > div,\n",
       ".xr-header > ul {\n",
       "  display: inline;\n",
       "  margin-top: 0;\n",
       "  margin-bottom: 0;\n",
       "}\n",
       "\n",
       ".xr-obj-type,\n",
       ".xr-array-name {\n",
       "  margin-left: 2px;\n",
       "  margin-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-obj-type {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-sections {\n",
       "  padding-left: 0 !important;\n",
       "  display: grid;\n",
       "  grid-template-columns: 150px auto auto 1fr 20px 20px;\n",
       "}\n",
       "\n",
       ".xr-section-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-section-item input {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-section-item input + label {\n",
       "  color: var(--xr-disabled-color);\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label {\n",
       "  cursor: pointer;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-item input:enabled + label:hover {\n",
       "  color: var(--xr-font-color0);\n",
       "}\n",
       "\n",
       ".xr-section-summary {\n",
       "  grid-column: 1;\n",
       "  color: var(--xr-font-color2);\n",
       "  font-weight: 500;\n",
       "}\n",
       "\n",
       ".xr-section-summary > span {\n",
       "  display: inline-block;\n",
       "  padding-left: 0.5em;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label {\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in + label:before {\n",
       "  display: inline-block;\n",
       "  content: '‚ñ∫';\n",
       "  font-size: 11px;\n",
       "  width: 15px;\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:disabled + label:before {\n",
       "  color: var(--xr-disabled-color);\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label:before {\n",
       "  content: '‚ñº';\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked + label > span {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-section-summary,\n",
       ".xr-section-inline-details {\n",
       "  padding-top: 4px;\n",
       "  padding-bottom: 4px;\n",
       "}\n",
       "\n",
       ".xr-section-inline-details {\n",
       "  grid-column: 2 / -1;\n",
       "}\n",
       "\n",
       ".xr-section-details {\n",
       "  display: none;\n",
       "  grid-column: 1 / -1;\n",
       "  margin-bottom: 5px;\n",
       "}\n",
       "\n",
       ".xr-section-summary-in:checked ~ .xr-section-details {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-array-wrap {\n",
       "  grid-column: 1 / -1;\n",
       "  display: grid;\n",
       "  grid-template-columns: 20px auto;\n",
       "}\n",
       "\n",
       ".xr-array-wrap > label {\n",
       "  grid-column: 1;\n",
       "  vertical-align: top;\n",
       "}\n",
       "\n",
       ".xr-preview {\n",
       "  color: var(--xr-font-color3);\n",
       "}\n",
       "\n",
       ".xr-array-preview,\n",
       ".xr-array-data {\n",
       "  padding: 0 5px !important;\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-array-data,\n",
       ".xr-array-in:checked ~ .xr-array-preview {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       ".xr-array-in:checked ~ .xr-array-data,\n",
       ".xr-array-preview {\n",
       "  display: inline-block;\n",
       "}\n",
       "\n",
       ".xr-dim-list {\n",
       "  display: inline-block !important;\n",
       "  list-style: none;\n",
       "  padding: 0 !important;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list li {\n",
       "  display: inline-block;\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "}\n",
       "\n",
       ".xr-dim-list:before {\n",
       "  content: '(';\n",
       "}\n",
       "\n",
       ".xr-dim-list:after {\n",
       "  content: ')';\n",
       "}\n",
       "\n",
       ".xr-dim-list li:not(:last-child):after {\n",
       "  content: ',';\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-has-index {\n",
       "  font-weight: bold;\n",
       "}\n",
       "\n",
       ".xr-var-list,\n",
       ".xr-var-item {\n",
       "  display: contents;\n",
       "}\n",
       "\n",
       ".xr-var-item > div,\n",
       ".xr-var-item label,\n",
       ".xr-var-item > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-even);\n",
       "  margin-bottom: 0;\n",
       "}\n",
       "\n",
       ".xr-var-item > .xr-var-name:hover span {\n",
       "  padding-right: 5px;\n",
       "}\n",
       "\n",
       ".xr-var-list > li:nth-child(odd) > div,\n",
       ".xr-var-list > li:nth-child(odd) > label,\n",
       ".xr-var-list > li:nth-child(odd) > .xr-var-name span {\n",
       "  background-color: var(--xr-background-color-row-odd);\n",
       "}\n",
       "\n",
       ".xr-var-name {\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-var-dims {\n",
       "  grid-column: 2;\n",
       "}\n",
       "\n",
       ".xr-var-dtype {\n",
       "  grid-column: 3;\n",
       "  text-align: right;\n",
       "  color: var(--xr-font-color2);\n",
       "}\n",
       "\n",
       ".xr-var-preview {\n",
       "  grid-column: 4;\n",
       "}\n",
       "\n",
       ".xr-var-name,\n",
       ".xr-var-dims,\n",
       ".xr-var-dtype,\n",
       ".xr-preview,\n",
       ".xr-attrs dt {\n",
       "  white-space: nowrap;\n",
       "  overflow: hidden;\n",
       "  text-overflow: ellipsis;\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-var-name:hover,\n",
       ".xr-var-dims:hover,\n",
       ".xr-var-dtype:hover,\n",
       ".xr-attrs dt:hover {\n",
       "  overflow: visible;\n",
       "  width: auto;\n",
       "  z-index: 1;\n",
       "}\n",
       "\n",
       ".xr-var-attrs,\n",
       ".xr-var-data {\n",
       "  display: none;\n",
       "  background-color: var(--xr-background-color) !important;\n",
       "  padding-bottom: 5px !important;\n",
       "}\n",
       "\n",
       ".xr-var-attrs-in:checked ~ .xr-var-attrs,\n",
       ".xr-var-data-in:checked ~ .xr-var-data {\n",
       "  display: block;\n",
       "}\n",
       "\n",
       ".xr-var-data > table {\n",
       "  float: right;\n",
       "}\n",
       "\n",
       ".xr-var-name span,\n",
       ".xr-var-data,\n",
       ".xr-attrs {\n",
       "  padding-left: 25px !important;\n",
       "}\n",
       "\n",
       ".xr-attrs,\n",
       ".xr-var-attrs,\n",
       ".xr-var-data {\n",
       "  grid-column: 1 / -1;\n",
       "}\n",
       "\n",
       "dl.xr-attrs {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  display: grid;\n",
       "  grid-template-columns: 125px auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt, dd {\n",
       "  padding: 0;\n",
       "  margin: 0;\n",
       "  float: left;\n",
       "  padding-right: 10px;\n",
       "  width: auto;\n",
       "}\n",
       "\n",
       ".xr-attrs dt {\n",
       "  font-weight: normal;\n",
       "  grid-column: 1;\n",
       "}\n",
       "\n",
       ".xr-attrs dt:hover span {\n",
       "  display: inline-block;\n",
       "  background: var(--xr-background-color);\n",
       "  padding-right: 10px;\n",
       "}\n",
       "\n",
       ".xr-attrs dd {\n",
       "  grid-column: 2;\n",
       "  white-space: pre-wrap;\n",
       "  word-break: break-all;\n",
       "}\n",
       "\n",
       ".xr-icon-database,\n",
       ".xr-icon-file-text2 {\n",
       "  display: inline-block;\n",
       "  vertical-align: middle;\n",
       "  width: 1em;\n",
       "  height: 1.5em !important;\n",
       "  stroke-width: 0;\n",
       "  stroke: currentColor;\n",
       "  fill: currentColor;\n",
       "}\n",
       "</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;\n",
       "Dimensions:            (box: 39, level: 6, time: 302043)\n",
       "Coordinates:\n",
       "  * time               (time) datetime64[ns] 2010-09-30T02:00:00 ... 2019-05-...\n",
       "  * box                (box) int64 2 3 4 5 6 7 8 9 ... 33 34 35 36 37 38 39 40\n",
       "  * level              (level) int64 1 2 3 4 5 6\n",
       "Data variables:\n",
       "    soilmoisture       (time, box, level) float64 nan nan nan ... -13.3 45.43\n",
       "    soiltemp           (time, box, level) float64 nan nan nan ... -15.55 7.928\n",
       "    soilmoisture_flag  (time, box, level) object nan nan ... &#x27;Manual&#x27;\n",
       "    soiltemp_flag      (time, box, level) object nan nan nan ... &#x27;Manual&#x27; &#x27;OK&#x27;\n",
       "    battery            (time, box) float64 nan nan nan ... 3.248e+03 3.392e+03</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-5f32fd7e-316e-4db3-a1ee-7d7328fd65b6' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5f32fd7e-316e-4db3-a1ee-7d7328fd65b6' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>box</span>: 39</li><li><span class='xr-has-index'>level</span>: 6</li><li><span class='xr-has-index'>time</span>: 302043</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-121cf0ce-d355-4574-aa32-0644028ed137' class='xr-section-summary-in' type='checkbox'  checked><label for='section-121cf0ce-d355-4574-aa32-0644028ed137' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2010-09-30T02:00:00 ... 2019-05-...</div><input id='attrs-80f90e4a-8e42-4f8f-a0cf-c734b4e1a843' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-80f90e4a-8e42-4f8f-a0cf-c734b4e1a843' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-baf8c78c-f03f-4c48-8b43-31d83068f6ca' class='xr-var-data-in' type='checkbox'><label for='data-baf8c78c-f03f-4c48-8b43-31d83068f6ca' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2010-09-30T02:00:00.000000000&#x27;, &#x27;2010-09-30T02:15:00.000000000&#x27;,\n",
       "       &#x27;2010-09-30T02:30:00.000000000&#x27;, ..., &#x27;2019-05-12T08:00:00.000000000&#x27;,\n",
       "       &#x27;2019-05-12T08:15:00.000000000&#x27;, &#x27;2019-05-12T08:30:00.000000000&#x27;],\n",
       "      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>box</span></div><div class='xr-var-dims'>(box)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2 3 4 5 6 7 8 ... 35 36 37 38 39 40</div><input id='attrs-49a816d3-daca-49d9-9ac0-cd8ce0afab5c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-49a816d3-daca-49d9-9ac0-cd8ce0afab5c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d5e04c9c-d4e7-4481-9beb-baf5d7d37891' class='xr-var-data-in' type='checkbox'><label for='data-d5e04c9c-d4e7-4481-9beb-baf5d7d37891' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,\n",
       "       20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37,\n",
       "       38, 39, 40])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6</div><input id='attrs-a860cfbf-5e6f-42d5-b20d-e1ee466476da' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a860cfbf-5e6f-42d5-b20d-e1ee466476da' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f852ca91-eff7-43c4-85b7-298d059b4b1d' class='xr-var-data-in' type='checkbox'><label for='data-f852ca91-eff7-43c4-85b7-298d059b4b1d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1, 2, 3, 4, 5, 6])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8062599b-8cc9-48db-a023-73f352e4b1e6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8062599b-8cc9-48db-a023-73f352e4b1e6' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>soilmoisture</span></div><div class='xr-var-dims'>(time, box, level)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... -14.39 -13.3 45.43</div><input id='attrs-3e91d670-718f-46ba-a065-92daa675990a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3e91d670-718f-46ba-a065-92daa675990a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-298941ff-611a-453a-a601-cefa84f3e7b1' class='xr-var-data-in' type='checkbox'><label for='data-298941ff-611a-453a-a601-cefa84f3e7b1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>soil moisture</dd><dt><span>units :</span></dt><dd>vol percent</dd></dl></div><div class='xr-var-data'><pre>array([[[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        ...,\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan]],\n",
       "\n",
       "       [[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        ...,\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan]],\n",
       "\n",
       "       [[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        ...,\n",
       "...\n",
       "        ...,\n",
       "        [276.4272,  -9.7329,  16.6275,  10.7914, -16.2046,  17.1041],\n",
       "        [-11.99  ,  19.1701,  13.9288, -12.3166,  45.4239, -13.1884],\n",
       "        [-13.0278,      nan, -10.7404, -14.3893, -13.3332,  45.318 ]],\n",
       "\n",
       "       [[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [-14.7645,  28.6488,      nan, -14.3105,      nan,  26.5471],\n",
       "        ...,\n",
       "        [276.4272,  -9.6804,  16.6643,  10.7668, -16.2374,  17.0353],\n",
       "        [-12.0144,  19.2076,  13.2511, -12.3177,  45.4199, -13.0786],\n",
       "        [-13.0278,      nan, -10.7404, -14.3893, -13.3035,  45.4276]],\n",
       "\n",
       "       [[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [-14.7658,  28.6412,      nan, -14.2176,      nan,  26.5471],\n",
       "        ...,\n",
       "        [276.4272,  -9.6452,  16.563 ,  10.7649, -16.2046,  17.1041],\n",
       "        [-12.0367,  19.1684,  13.8002, -12.2926,  46.2452, -13.0508],\n",
       "        [-13.0278,      nan, -10.7404, -14.3893, -13.3035,  45.4276]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>soiltemp</span></div><div class='xr-var-dims'>(time, box, level)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... -17.91 -15.55 7.928</div><input id='attrs-cc2ea50b-c6dc-48da-9f10-832110c4be4c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cc2ea50b-c6dc-48da-9f10-832110c4be4c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9013bb4e-aae6-4b53-926f-e2eed68f225d' class='xr-var-data-in' type='checkbox'><label for='data-9013bb4e-aae6-4b53-926f-e2eed68f225d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>soil temperature</dd><dt><span>units :</span></dt><dd>deg C</dd></dl></div><div class='xr-var-data'><pre>array([[[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        ...,\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan]],\n",
       "\n",
       "       [[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        ...,\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan]],\n",
       "\n",
       "       [[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        ...,\n",
       "...\n",
       "        ...,\n",
       "        [  8.2414, -15.2004,   7.8588,   8.0675,  61.733 ,   8.0327],\n",
       "        [-16.522 ,   9.0065,   8.6935, -16.9741,   9.0065, -17.0437],\n",
       "        [-18.3653, -18.3306, -18.4349, -17.9132, -15.5482,   7.9283]],\n",
       "\n",
       "       [[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [-15.0612,  13.4584, -13.5657, -11.3398, -15.409 ,   8.0675],\n",
       "        ...,\n",
       "        [  8.2414, -15.1308,   7.9283,   8.1718,  61.733 ,   8.0675],\n",
       "        [-16.4872,   9.0065,   8.5544, -16.9394,   8.9717, -16.9741],\n",
       "        [-18.3653, -18.3306, -18.4349, -17.9132, -15.5482,   7.9283]],\n",
       "\n",
       "       [[     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [     nan,      nan,      nan,      nan,      nan,      nan],\n",
       "        [-15.0265,  13.354 , -13.4961, -11.2702, -15.3395,   8.0675],\n",
       "        ...,\n",
       "        [  8.2414, -15.096 ,   7.9283,   8.1022,  61.733 ,   8.0327],\n",
       "        [-16.522 ,   8.9717,   8.5544, -16.9394,   9.0065, -16.9741],\n",
       "        [-18.3653, -18.3306, -18.4349, -17.9132, -15.5482,   7.9283]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>soilmoisture_flag</span></div><div class='xr-var-dims'>(time, box, level)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>nan nan ... &#x27;Auto:Range&#x27; &#x27;Manual&#x27;</div><input id='attrs-73449504-d150-4ae5-8e63-0f2872ccdc5d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-73449504-d150-4ae5-8e63-0f2872ccdc5d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2a80bf93-71d6-4c03-b159-21e8c82d146a' class='xr-var-data-in' type='checkbox'><label for='data-2a80bf93-71d6-4c03-b159-21e8c82d146a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>soil moisture qa flag</dd><dt><span>units :</span></dt><dd>category</dd><dt><span>flag_values :</span></dt><dd>0,1,2,3,4</dd><dt><span>flag_meanings :</span></dt><dd>Auto:BattV Auto:Range Auto:Spike Manual OK</dd></dl></div><div class='xr-var-data'><pre>array([[[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        ...,\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan]],\n",
       "\n",
       "       [[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        ...,\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan]],\n",
       "\n",
       "       [[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        ...,\n",
       "...\n",
       "\n",
       "       [[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [&#x27;Auto:Range&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;,\n",
       "         &#x27;OK&#x27;],\n",
       "        ...,\n",
       "        [&#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;, &#x27;Manual&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;],\n",
       "        [&#x27;Auto:Range&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;],\n",
       "        [&#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;,\n",
       "         &#x27;Auto:Range&#x27;, &#x27;Manual&#x27;]],\n",
       "\n",
       "       [[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [&#x27;Auto:Range&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;,\n",
       "         &#x27;OK&#x27;],\n",
       "        ...,\n",
       "        [&#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;, &#x27;Manual&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;],\n",
       "        [&#x27;Auto:Range&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;],\n",
       "        [&#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;, &#x27;Auto:Range&#x27;,\n",
       "         &#x27;Auto:Range&#x27;, &#x27;Manual&#x27;]]], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>soiltemp_flag</span></div><div class='xr-var-dims'>(time, box, level)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>nan nan nan ... &#x27;Manual&#x27; &#x27;OK&#x27;</div><input id='attrs-62fa1f7c-0115-4c9b-b0bc-4a62477f36b6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-62fa1f7c-0115-4c9b-b0bc-4a62477f36b6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3d853e61-8f5a-49f4-97b9-34f56a28876b' class='xr-var-data-in' type='checkbox'><label for='data-3d853e61-8f5a-49f4-97b9-34f56a28876b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>soil temperature qa flag</dd><dt><span>units :</span></dt><dd>category</dd><dt><span>flag_values :</span></dt><dd>0,1,2,3,4</dd><dt><span>flag_meanings :</span></dt><dd>Auto:BattV Auto:Range Auto:Spike Manual OK</dd></dl></div><div class='xr-var-data'><pre>array([[[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        ...,\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan]],\n",
       "\n",
       "       [[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        ...,\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan]],\n",
       "\n",
       "       [[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        ...,\n",
       "...\n",
       "        [&#x27;OK&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;],\n",
       "        [&#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;Manual&#x27;],\n",
       "        [&#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;]],\n",
       "\n",
       "       [[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [&#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;],\n",
       "        ...,\n",
       "        [&#x27;OK&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;],\n",
       "        [&#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;Manual&#x27;],\n",
       "        [&#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;]],\n",
       "\n",
       "       [[nan, nan, nan, nan, nan, nan],\n",
       "        [nan, nan, nan, nan, nan, nan],\n",
       "        [&#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;],\n",
       "        ...,\n",
       "        [&#x27;OK&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Auto:Range&#x27;, &#x27;OK&#x27;],\n",
       "        [&#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;OK&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;, &#x27;Manual&#x27;],\n",
       "        [&#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;Manual&#x27;, &#x27;OK&#x27;]]],\n",
       "      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>battery</span></div><div class='xr-var-dims'>(time, box)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 3.248e+03 3.392e+03</div><input id='attrs-b6681c93-6da9-4bac-b5df-117edbdb1a62' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b6681c93-6da9-4bac-b5df-117edbdb1a62' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b0fd8a28-c389-47e6-ab8b-0667cc16c40c' class='xr-var-data-in' type='checkbox'><label for='data-b0fd8a28-c389-47e6-ab8b-0667cc16c40c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[  nan,   nan,   nan, ...,   nan,   nan,   nan],\n",
       "       [  nan,   nan,   nan, ...,   nan,   nan,   nan],\n",
       "       [  nan,   nan,   nan, ...,   nan,   nan,   nan],\n",
       "       ...,\n",
       "       [  nan,   nan, 3086., ..., 3464., 3235., 3387.],\n",
       "       [  nan,   nan, 3087., ..., 3467., 3246., 3389.],\n",
       "       [  nan,   nan, 3088., ..., 3470., 3248., 3392.]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-023b7a93-573c-4ae7-8729-8481694b1e26' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-023b7a93-573c-4ae7-8729-8481694b1e26' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>"
      ],
      "text/plain": [
       "<xarray.Dataset>\n",
       "Dimensions:            (box: 39, level: 6, time: 302043)\n",
       "Coordinates:\n",
       "  * time               (time) datetime64[ns] 2010-09-30T02:00:00 ... 2019-05-...\n",
       "  * box                (box) int64 2 3 4 5 6 7 8 9 ... 33 34 35 36 37 38 39 40\n",
       "  * level              (level) int64 1 2 3 4 5 6\n",
       "Data variables:\n",
       "    soilmoisture       (time, box, level) float64 nan nan nan ... -13.3 45.43\n",
       "    soiltemp           (time, box, level) float64 nan nan nan ... -15.55 7.928\n",
       "    soilmoisture_flag  (time, box, level) object nan nan ... 'Manual'\n",
       "    soiltemp_flag      (time, box, level) object nan nan nan ... 'Manual' 'OK'\n",
       "    battery            (time, box) float64 nan nan nan ... 3.248e+03 3.392e+03"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ds = xr.merge([ds, ds_bat])\n",
    "ds"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "ds.to_netcdf(\"ufz_hohes-holz.nc\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
